<% content_for :channels do %>
  <%= javascript_pack_tag 'channels/lobby' %>
<% end %>

<div id="roomId" data-room-id="<%= @room_id %>"></div>

<div class="row lobby-container m-0 p-0">
  <div class="col-8 qrcode-container">
    <div>
      <h4 class="text-center">Scan QR code</h4>
      <p class="text-center">Scan this QR code to join the lobby.</p>
      <div class="qrcode-wrapper"><%= raw @QRCSVG %></div>
      <p class="text-center">--------- 0r ----------</p>
      <p><%= @new_player_url %></p>
    </div>
  </div>

  <div class="col-4 lobby-wrapper">
    <h1 class="text-center">Lobby</h1>
    <h3 class="text-center lobby-roomName"><%= @room.name %></h3>
    <hr>
    <div id="users">
      <h3 class="lobby-playersTitle">Players</h3>
      <div id="userList" class="lobby-playerList">
        <% @room.players.each do |player| %>
          <%= render partial: 'shared/player_large', locals: { player: player } %>
        <% end %>
        <% if @room.players.empty? %>
          <p>Wating for players to join.</p>
        <% end %>
      </div>
    </div>
    <%= link_to 'Start', room_show_main_path(room_id: @room.room_id), class: 'btn btn-primary lobby-button' %>
  </div>

</div>

<script>
  let playerIconStyle = `<%= render partial: 'shared/player_large', locals: { player: OpenStruct.new(name: 'templateName', avatar: 'cool.png', colour: 'templateColour') } %>`
  const playerJoinedSound = new Audio(`<%= audio_path 'join_lobby.flac' %>`);
</script>
