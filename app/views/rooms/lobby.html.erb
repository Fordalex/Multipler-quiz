<% content_for :channels do %>
  <%= javascript_pack_tag 'channels/lobby' %>
<% end %>

<% content_for :extra_js do %>
  <script src="https://unpkg.com/vue@3"></script>
<% end %>

<div id="roomId" data-room-id="<%= @room_id %>"></div>

<div class="row lobby-container m-0 p-0">
  <div class="col-7 qrcode-container">
    <div>
      <h4 class="text-center">Scan QR code</h4>
      <p class="text-center">Scan this QR code to join the lobby.</p>
      <div class="qrcode-wrapper"><%= raw @QRCSVG %></div>
      <p class="text-center">--------- 0r ----------</p>
      <p><%= @new_player_url %></p>
    </div>
  </div>

  <div class="col-5 lobby-wrapper">
    <h1 class="text-center">Lobby</h1>
    <h3 class="text-center lobby-roomName"><%= @room.name %></h3>
    <hr>
      <h3 class="lobby-playersTitle">Settings</h3>
      <table class="table table-striped">
        <tr>
          <td>Number of Rounds</td>
          <td><%= @room.rounds %></td>
        </tr>
      </table>
    <hr>
    <div id="users">
      <h3 class="lobby-playersTitle">Players</h3>
      <div id="userList" class="lobby-playerList">
        <div id="app">
          <player v-for="player in players" :key="player.id" :name="player.name"></player>
        </div>
      </div>
    </div>
    <%= link_to 'Start', room_show_main_path(room_id: @room.room_id), class: 'btn btn-primary lobby-button' %>
  </div>
</div>

<!-- Import the app -->
<%= javascript_pack_tag 'frontend/app.js' %>

<!-- Import components -->
<%= javascript_pack_tag 'frontend/components/PlayerLarge.js' %>

<script>
  document.addEventListener('DOMContentLoaded', () => {
    window.app.mount("#app");
  })
</script>

<script>
  let playerIconStyle = `<%= render partial: 'shared/player_large', locals: { player: OpenStruct.new(name: 'templateName', avatar: 'cool.png', colour: 'templateColour') } %>`
  const playerJoinedSound = new Audio(`<%= audio_path 'join_lobby.flac' %>`);
</script>

